# playdata-mysql-db

## ì„¤ëª…
ì´ í”„ë¡œì íŠ¸ëŠ” MMORPGì˜ dbë¥¼ ì‘ê²Œ êµ¬í˜„í•˜ì—¬ ê·¸ ì•ˆì— í•„ìš”í•œ í…Œì´ë¸”ê³¼ ê¸°ëŠ¥ë“¤ì„ MySQLì„ í™œìš©í•´ êµ¬í˜„í•´ë³´ëŠ” í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.

## ëª©í‘œ
* MySQLì˜ DDLì„ í™œìš©í•´ í•„ìš”í•œ tableì„ ìƒì„±í•©ë‹ˆë‹¤.
* MySQLì˜ DML, TCLì„ í™œìš©í•´ í•„ìš”í•œ ê¸°ëŠ¥ë“¤ì„ êµ¬í˜„í•©ë‹ˆë‹¤.
* MySQLì˜ function, procedure, triggerë¥¼ í™œìš©í•´ í•„ìš”í•œ ê¸°ëŠ¥ë“¤ì„ êµ¬í˜„í•©ë‹ˆë‹¤


## Tech Stack
<img src="https://img.shields.io/badge/mysql-4479A1?style=for-the-badge&logo=mysql&logoColor=white">
<img src="https://img.shields.io/badge/dbeaver-003B57?style=for-the-badge&logo=dbeaver&logoColor=white">

## Project Configuration
```bash
ğŸ“¦ Databases
â””â”€Â playdata
Â Â Â â”œâ”€Â Tables
Â Â Â â”‚Â Â â”œâ”€Â guild
Â Â Â â”‚Â Â â””â”€Â player
Â Â Â â”œâ”€Â Procedures
Â Â Â â”‚Â Â â”œâ”€Â auto_charge
Â Â Â â”‚Â Â â”œâ”€Â create_guild
Â Â Â â”‚Â Â â”œâ”€Â find_friend
Â Â Â â”‚Â Â â”œâ”€Â find_new_member
Â Â Â â”‚Â Â â”œâ”€Â leaving_guild
Â Â Â â”‚Â Â â”œâ”€Â level_up
Â Â Â â”‚Â Â â”œâ”€Â purchase_item
Â Â Â â”‚Â Â â”œâ”€Â pvp_matching
Â Â Â â”‚Â Â â””â”€Â signing_up_guild
Â Â Â â””â”€Â Trigger
Â Â Â Â Â Â â””â”€Â player.new_player_event
```
Â©generated by [Project Tree Generator](https://woochanleee.github.io/project-tree-generator)

## Files
* tables_mysql.sql
* scenarios_mysql.sql

### tables_mysql.sql
guild tableê³¼ player tableì„ ìƒì„±í•˜ë©°, dataë¥¼ ì‚½ì…í•˜ëŠ” insertë¬¸ì„ ì‘ì„±í•œ mysql script file ì…ë‹ˆë‹¤. ì•„ë˜ëŠ” guild tableê³¼ player tableì˜ ì˜ˆì‹œì…ë‹ˆë‹¤.

* guild table
```sql
-- ê¸¸ë“œ í…Œì´ë¸” ìƒì„±
CREATE TABLE guild(
-- column ì •ì˜
	gno			INT AUTO_INCREMENT,		-- ê¸¸ë“œ ë²ˆí˜¸, PK
	name		VARCHAR(10),			-- ê¸¸ë“œëª…
	tend		VARCHAR(10),			-- ê¸¸ë“œ ì„±í–¥, ì „íˆ¬/ìƒí™œ/ì¹œëª©
	reg			VARCHAR(10),			-- ê¸¸ë“œ í™œë™ ì§€ì—­, ë¶ë¶€/ì„œë¶€/ë™ë¶€/ë‚¨ë¶€/ì¤‘ì•™
	lev			SMALLINT,				-- ê¸¸ë“œ LEVEL
	create_date	DATE,					-- ê¸¸ë“œ ìƒì„± ì¼
-- pk ì •ì˜
	CONSTRAINT pk_gno_guild PRIMARY KEY (gno)
);
```

* player table
```sql
-- í”Œë ˆì´ì–´ í…Œì´ë¸” ìƒì„±
CREATE TABLE player(
-- column ì •ì˜
	id			VARCHAR(10),	-- í”Œë ˆì´ì–´ ìºë¦­í„° id, PK
	gno			INT,			-- ê¸¸ë“œ ë²ˆí˜¸, FK
	job 		VARCHAR(10),	-- ì§ì—…, ì „ì‚¬/ê¶ìˆ˜/ë§ˆë²•ì‚¬/ì„±ì§ì/ì•”ì‚´ì
	lev			SMALLINT,		-- LEVEL
	str			INT,			-- ì „íˆ¬ë ¥
	sex			VARCHAR(1),		-- ì„±ë²Œ(M, F)
	rid			VARCHAR(10),	-- ëŒ€í‘œ í”Œë ˆì–´ì´ ìºë¦­í„° id
	create_date	DATE,			-- ìºë¦­í„° ìƒì„± ì¼
	last_date	DATE,			-- ìµœê·¼ ì ‘ì†ì¼
	cash		int,			-- ëˆ„ì  ê²°ì œ ê¸ˆì•¡
-- pk, fk ì •ì˜
	CONSTRAINT pk_id_adventurer PRIMARY KEY (id),
	CONSTRAINT fk_gno_adventurer FOREIGN KEY (gno) REFERENCES guild(gno)
);
```

### scenarios_mysql.sql
guild tableê³¼ player tableì„ í™œìš©í•´ êµ¬í˜„í•œ ê¸°ëŠ¥ë“¤ì„ ì‘ì„±í•œ mysql script fileì…ë‹ˆë‹¤. ì•„ë˜ëŠ” êµ¬í˜„í•œ ê¸°ëŠ¥ë“¤ì˜ ì˜ˆì‹œì…ë‹ˆë‹¤.

* ê¸¸ë“œ ìƒì„±
```sql
DROP PROCEDURE IF EXISTS create_guild;

-- ê¸¸ë“œ ìƒì„± Procedure ìƒì„±
CREATE PROCEDURE create_guild(guild_name VARCHAR(30) BINARY)
BEGIN
	INSERT INTO guild (name, create_date)
	VALUES (guild_name, CURDATE());
	SELECT *
	FROM guild
	WHERE name = guild_name;
END;
```

```sql
-- ê¸¸ë“œ ìƒì„± Procedure ì‹¤í–‰
CALL create_guild('ì‹ ê·œê¸¸ë“œ01');
```

ì‹¤í–‰ ê²°ê³¼
|gno|name|tend|reg|lev|create_date|
|---|---|---|---|---|---|
|1006|ì‹ ê·œê¸¸ë“œ01|NULL|NULL|1|2022-06-07|

* ê¸¸ë“œ ê°€ì…
```sql
DROP PROCEDURE IF EXISTS signing_up_guild;

-- ê¸¸ë“œ ê°€ì… Procedure ìƒì„±
CREATE PROCEDURE signing_up_guild (player_id VARCHAR(30) BINARY, guild_name VARCHAR(30) BINARY)
BEGIN
	UPDATE player
	SET gno = (
		SELECT gno
		FROM guild
		WHERE guild.name = guild_name
	)
	WHERE id = player_id AND gno IS NULL;
	COMMIT;
	SELECT id, gno
	FROM player
	WHERE id = player_id;
END;
```

```sql
-- ê¸¸ë“œ ê°€ì… Procedure ì‹¤í–‰
CALL signing_up_guild('ì‹ ê·œí”Œë ˆì´ì–´01', 'ì‹ ê·œê¸¸ë“œ01');
```

ì‹¤í–‰ ê²°ê³¼
|id|gno|
|---|---|
|ì‹ ê·œí”Œë ˆì´ì–´01|1006|

## Contributors
* ë°•ì¬ë¯¼
* ìœ¤í™ì°¬
* ìœ¤ì˜ˆì§€
